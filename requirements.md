# 钓鱼天气应用 (Fishing Weather App) - 产品需求文档

## 1. 产品概述

### 1.1 产品定位
钓鱼天气应用是一款面向钓鱼爱好者的综合性移动应用，旨在通过提供精准的天气信息和钓鱼适宜度评估，帮助用户选择最佳钓鱼时机，同时提供钓点分享、鱼获展示和社区互动功能，打造完整的钓鱼爱好者社交平台。

### 1.2 目标用户
- 钓鱼爱好者（休闲和专业）
- 户外运动爱好者
- 对天气信息有特定需求的用户

### 1.3 产品价值
- 为钓鱼爱好者提供专业的钓鱼适宜度评估，提高钓鱼成功率
- 构建钓鱼爱好者社区，促进信息和经验分享
- 提供便捷的天气查询和钓点分享功能

## 2. 用户故事

### 2.1 天气和钓鱼适宜度功能

#### 用户故事 1: 快速查看当前位置的钓鱼适宜度
作为一名钓鱼爱好者，我希望打开应用后能立即看到当前位置的钓鱼适宜度评估，以便我能快速决定今天是否适合钓鱼。
- **验收标准**:
  - 应用启动后，通过IP定位自动获取当前位置
  - 显示当前位置的天气信息和钓鱼适宜度评估结果
  - 钓鱼适宜度以直观的颜色和等级(极佳/良好/一般/较差)显示

#### 用户故事 2: 查看精确位置的钓鱼适宜度
作为一名钓鱼爱好者，我希望能够使用GPS获取我精确位置的天气和钓鱼适宜度，以便在我实际钓鱼地点获得更准确的信息。
- **验收标准**:
  - 提供GPS定位按钮，点击后获取精确位置
  - 显示精确位置的天气信息和钓鱼适宜度
  - 显示定位成功的提示信息

#### 用户故事 3: 搜索特定城市的钓鱼适宜度
作为一名计划出行的钓鱼爱好者，我希望能搜索特定城市的钓鱼适宜度，以便提前了解目的地的钓鱼条件。
- **验收标准**:
  - 提供城市搜索功能
  - 显示搜索结果城市的天气信息和钓鱼适宜度
  - 支持历史搜索记录

#### 用户故事 4: 查看未来天气预报和钓鱼适宜度
作为一名钓鱼爱好者，我希望查看未来几天的天气预报和钓鱼适宜度，以便提前规划钓鱼活动。
- **验收标准**:
  - 显示未来3-7天的天气预报
  - 每天的预报包含钓鱼适宜度评估
  - 提供详细的天气参数(温度、风速、降水等)

#### 用户故事 5: 获取详细的钓鱼建议
作为一名钓鱼爱好者，我希望根据当前天气获取详细的钓鱼建议，以便调整我的钓鱼策略。
- **验收标准**:
  - 根据天气状况提供具体的钓鱼建议
  - 建议包括适合的钓鱼技巧、鱼种和装备
  - 建议根据钓鱼适宜度等级有所不同

### 2.2 社交和分享功能

#### 用户故事 6: 注册和登录账户
作为一名用户，我希望能够创建账户并登录，以便使用应用的社交功能。
- **验收标准**:
  - 提供注册功能，支持邮箱注册
  - 提供登录功能，支持记住登录状态
  - 支持修改个人资料和密码

#### 用户故事 7: 分享钓点位置
作为一名钓鱼爱好者，我希望能分享我发现的好钓点，以便与其他钓友交流。
- **验收标准**:
  - 提供钓点分享功能，支持添加位置、描述和标签
  - 分享的钓点显示在地图上
  - 支持删除自己分享的钓点

#### 用户故事 8: 查看附近钓点
作为一名钓鱼爱好者，我希望查看附近的钓点，以便发现新的钓鱼地点。
- **验收标准**:
  - 在地图上显示附近的钓点
  - 支持按距离筛选钓点
  - 点击钓点查看详细信息

#### 用户故事 9: 分享鱼获
作为一名钓鱼爱好者，我希望分享我的鱼获照片和经验，以便记录成果并与社区交流。
- **验收标准**:
  - 提供鱼获分享功能，支持上传图片
  - 支持添加描述、位置和标签
  - 分享的鱼获显示在社区feed中

#### 用户故事 10: 社区互动
作为一名钓鱼爱好者，我希望能与其他用户互动，对他们的分享进行点赞和评论。
- **验收标准**:
  - 支持对鱼获进行点赞
  - 支持对鱼获进行评论
  - 提供查看点赞和评论列表的功能

#### 用户故事 11: 查看个人资料
作为一名用户，我希望查看自己和其他用户的个人资料，包括分享的钓点和鱼获。
- **验收标准**:
  - 提供个人资料页面，显示用户基本信息
  - 显示用户分享的钓点和鱼获
  - 支持查看自己点赞过的内容

### 2.3 地图功能

#### 用户故事 12: 在地图上查看钓点
作为一名钓鱼爱好者，我希望在地图上查看钓点分布，以便直观了解各个钓点的位置关系。
- **验收标准**:
  - 提供地图视图，显示钓点标记
  - 支持地图缩放和平移
  - 点击标记查看钓点详情

#### 用户故事 13: 在地图上添加新钓点
作为一名钓鱼爱好者，我希望能在地图上直接添加新钓点，以便快速分享位置。
- **验收标准**:
  - 支持点击地图任意位置添加新钓点
  - 提供添加钓点的表单，包括名称、描述等字段
  - 成功添加后在地图上显示新钓点

### 2.4 设置和偏好

#### 用户故事 14: 切换语言
作为一名国际用户，我希望能够切换应用语言，以便使用我熟悉的语言。
- **验收标准**:
  - 提供语言设置选项，支持中文和英文
  - 切换语言后，整个应用界面立即更新
  - 语言设置被保存，下次启动应用时自动应用

#### 用户故事 15: 查看离线缓存的天气数据
作为一名在网络不稳定区域的用户，我希望在离线状态下也能查看缓存的天气数据。
- **验收标准**:
  - 在无网络连接时显示最近缓存的天气数据
  - 显示数据的缓存时间
  - 提供手动刷新按钮，在恢复网络连接后更新数据

#### 用户故事 16: 使用主屏幕小部件
作为一名频繁查看天气的用户，我希望通过主屏幕小部件快速查看天气和钓鱼适宜度，而不必打开应用。
- **验收标准**:
  - 提供主屏幕小部件，显示当前位置的天气和钓鱼适宜度
  - 小部件定期自动更新数据
  - 点击小部件可打开应用

## 3. 功能规格

### 3.1 钓鱼适宜度评估系统
- 基于8项气象因素评估钓鱼适宜度：气压、天气状况、降水概率、云量、风速、温度、湿度、能见度
- 评分标准：
  - 气压：1005-1015 hPa最佳(+2分)，>1015 hPa次之(+1分)，<1005 hPa较差(-1分)
  - 天气状况：晴好天气(+2分)，小雨/零星降雨(0分)，雾/薄雾(-1分)，大雨/恶劣天气(-2分)
  - 降水概率：<30%(+2分)，30-60%(0分)，>60%(-1分)
  - 云量：20-60%(+2分)，<20%或60-80%(0分)，>80%(-1分)
  - 风速：2-10 km/h(+2分)，<2或10-15 km/h(0分)，>15 km/h(-2分)
  - 温度：15-30°C(+2分)，<15°C或30-35°C(0分)，>35°C或极低温(-2分)
  - 湿度：40-80%(+2分)，<40%或80-90%(0分)，>90%(-1分)
  - 能见度：>5km(+2分)，2-5km(0分)，<2km(-2分)
- 适宜度等级：
  - 极佳(Excellent)：≥12分，绿色标识
  - 良好(Good)：8-11分，蓝色标识
  - 一般(Moderate)：4-7分，橙色标识
  - 较差(Poor)：<4分，红色标识

### 3.2 天气数据获取
- 支持三种获取天气数据的方式：
  - IP定位：应用首次启动时使用
  - GPS定位：用户手动刷新位置时使用
  - 城市名称搜索：用户手动输入城市名称
- 天气数据来源：wttr.in API，格式为JSON
- 缓存机制：
  - 天气数据缓存：减少网络请求
  - 钓鱼适宜度评估缓存：减少计算开销
  - IP定位缓存时间：30分钟

### 3.3 用户认证系统
- 注册功能：支持邮箱注册
- 登录功能：支持记住登录状态
- 个人资料管理：修改个人信息、头像
- 密码管理：修改密码、找回密码
- 认证机制：JWT认证

### 3.4 钓点分享系统
- 钓点创建：支持添加位置、名称、描述、标签
- 钓点查询：支持按距离、名称查询
- 钓点管理：支持删除自己的钓点
- 钓点详情：显示位置、创建者、描述等信息

### 3.5 鱼获分享系统
- 鱼获创建：支持上传图片、添加描述、位置、标签
- 鱼获查询：支持按时间、热度查询
- 鱼获管理：支持删除自己的鱼获
- 鱼获详情：显示图片、描述、位置、创建者等信息

### 3.6 社区互动功能
- 点赞功能：支持对鱼获进行点赞
- 评论功能：支持对鱼获进行评论
- 社交分享：支持分享到多个社交平台

### 3.7 地图功能
- 地图显示：显示钓点分布
- 地图交互：支持缩放、平移、点击
- 钓点标记：显示钓点位置和基本信息
- 新钓点添加：支持在地图上直接添加新钓点

### 3.8 多语言支持
- 支持中文和英文
- 支持动态切换语言
- 所有文本内容支持国际化

### 3.9 主屏幕小部件
- 支持iOS和Android平台
- 显示当前位置的天气和钓鱼适宜度
- 定期自动更新数据

## 4. 非功能需求

### 4.1 性能需求
- 应用启动时间：<3秒
- 天气数据加载时间：<2秒
- 地图加载时间：<3秒
- 图片上传时间：<5秒(取决于网络状况)

### 4.2 可用性需求
- 应用界面简洁直观，操作流程清晰
- 提供用户引导和帮助信息
- 支持离线模式，在无网络连接时显示缓存数据
- 错误提示友好，提供解决建议

### 4.3 安全需求
- 用户密码加密存储
- 敏感操作需要身份验证
- 防止SQL注入和XSS攻击
- 图片上传前进行安全检查

### 4.4 兼容性需求
- 支持Android 5.0及以上版本
- 支持iOS 11.0及以上版本
- 适配不同屏幕尺寸和分辨率
- 支持横屏和竖屏模式

## 5. 技术架构

### 5.1 前端架构
- 开发框架：Flutter
- 状态管理：Provider
- 网络请求：http
- 本地存储：shared_preferences
- 地图组件：flutter_map
- 图片处理：image_picker

### 5.2 后端架构
- 开发框架：FastAPI
- 数据库：MySQL
- 认证机制：JWT
- API设计：RESTful
- 文件存储：本地文件系统

### 5.3 数据模型
- 用户模型：用户基本信息、认证信息
- 天气模型：天气数据、钓鱼适宜度评估
- 钓点模型：位置、名称、描述、创建者
- 鱼获模型：图片、描述、位置、创建者
- 交互模型：点赞、评论

## 6. 项目里程碑

### 6.1 第一阶段：基础天气功能
- 实现天气数据获取和显示
- 实现钓鱼适宜度评估系统
- 实现多语言支持
- 实现缓存机制

### 6.2 第二阶段：用户系统和社交功能
- 实现用户注册和登录
- 实现钓点分享功能
- 实现鱼获分享功能
- 实现社区互动功能

### 6.3 第三阶段：地图和高级功能
- 实现地图显示和交互
- 实现主屏幕小部件
- 实现社交分享功能
- 优化网络连接和错误处理

### 6.4 第四阶段：测试和优化
- 进行功能测试和性能测试
- 优化用户界面和体验
- 修复已知问题
- 准备应用发布

## 7. 风险评估

### 7.1 技术风险
- 地图加载失败：实现多地图源自动切换和离线模式
- 网络连接不稳定：实现智能重试和离线缓存
- 图片上传失败：实现断点续传和自动重试

### 7.2 业务风险
- 用户活跃度不足：提供有吸引力的内容和功能
- 数据准确性问题：使用多个数据源验证天气信息
- 用户隐私问题：明确隐私政策，提供隐私保护选项

## 8. 附录

### 8.1 术语表
- 钓鱼适宜度：根据天气条件评估的钓鱼活动适宜程度
- 钓点：适合钓鱼的地点
- 鱼获：钓鱼的收获，通常指捕获的鱼
- JWT：JSON Web Token，用于用户认证的开放标准

### 8.2 参考资料
- wttr.in API文档
- One Call API 3.0 https://openweathermap.org/api