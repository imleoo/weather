# iOS小部件配置指南

本指南将帮助您在Xcode中配置和运行钓鱼天气应用的iOS小部件。

## 前提条件

- Xcode 12.0或更高版本
- iOS 14.0或更高版本的设备或模拟器
- Apple开发者账号（免费账号也可以，但有一些限制）
- 已安装CocoaPods

## 配置步骤

### 1. 运行配置脚本

我们已经准备了一个脚本来自动添加小部件扩展到Xcode项目中。在终端中执行以下命令：

```bash
cd ios
./add_widget_target.sh
```

这个脚本会：
- 创建必要的小部件文件夹和文件
- 向Xcode项目添加小部件扩展目标
- 更新Podfile并运行`pod install`

### 2. 在Xcode中打开项目

```bash
open Runner.xcworkspace
```

### 3. 配置签名和权限

1. 在Xcode中，选择项目导航器中的项目
2. 选择"Runner"目标
3. 在"Signing & Capabilities"选项卡中：
   - 确保选择了正确的Team
   - 如果没有自动添加，点击"+"按钮添加"App Groups"能力
   - 确保App Group ID为"group.cn.leoobai.fishingweather"

4. 同样，选择"FishingWidget"目标
5. 在"Signing & Capabilities"选项卡中：
   - 确保选择了与Runner相同的Team
   - 确保添加了"App Groups"能力
   - 确保App Group ID为"group.cn.leoobai.fishingweather"

### 4. 构建和运行

1. 选择一个iOS 14.0或更高版本的设备或模拟器
2. 点击运行按钮构建和运行应用
3. 应用安装后，返回主屏幕
4. 长按任意空白区域进入编辑模式
5. 点击左上角的"+"按钮
6. 搜索"钓鱼天气"或滚动查找我们的小部件
7. 选择小部件并添加到主屏幕

## 小部件功能

钓鱼天气小部件提供三种尺寸：

1. **小尺寸**：显示基本天气信息和钓鱼适宜度评分
2. **中尺寸**：显示更详细的天气信息和钓鱼适宜度
3. **大尺寸**：显示完整的天气信息和钓鱼适宜度详情

小部件会每30分钟自动更新一次。用户也可以通过打开应用来手动更新数据。

## 故障排除

### 小部件不显示数据

1. 确保应用至少运行过一次，以便生成初始数据
2. 检查App Groups权限是否正确配置
3. 尝试重新添加小部件到主屏幕

### 构建错误

1. 确保已运行`pod install`
2. 检查签名配置是否正确
3. 尝试清理构建文件夹（Product > Clean Build Folder）

### 小部件不更新

1. 确保应用在后台任务中有权限运行
2. 检查是否启用了后台刷新（设置 > 通用 > 后台应用刷新）
3. 手动打开应用触发数据更新

## 注意事项

- iOS小部件是只读的，用户不能直接在小部件上进行交互
- 小部件的更新频率受系统限制，不能保证实时更新
- 小部件的内存和CPU使用受到严格限制
- 在真机上测试小部件比在模拟器上更准确